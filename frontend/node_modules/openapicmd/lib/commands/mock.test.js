"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const test_1 = require("@oclif/test");
const waitOn = require("wait-on");
const test_utils_1 = require("../__tests__/test-utils");
require("chai");
const TEST_PORT = 5552;
describe('mock', () => {
    test_1.test
        .stdout()
        .command(['mock', (0, test_utils_1.resourcePath)('openapi.yml'), '-p', `${TEST_PORT}`])
        .it('runs openapi-backend mock server', async (ctx) => {
        await waitOn({ resources: [`tcp:localhost:${TEST_PORT}`] });
        (0, test_1.expect)(ctx.stdout).to.contain('running');
    });
    afterEach(() => {
        // emit disconnect to stop the server
        process.emit('disconnect');
    });
});
